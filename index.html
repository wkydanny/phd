<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WUP_PhD_2024-25</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            background-color: grey;
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 40px;
        }
        .logo {
            max-width: 125px;
            height: auto;
        }
        .zoom-link {
            display: inline-block;
            margin-top: 30px;
            padding: 6px 12px;
            text-decoration: none;
            border: 1px solid #333;
            border-radius: 2px;
            font-size: 14px;
        }
        .zoom-link:hover {
            background-color: #f0f0f0;
        }
        .drive-link {
            display: block;
            margin-top: 10px;
        }
        #folder-status {
            margin-top: 40px;
            font-size: 14px;
            padding: 10px;
            border-top: 1px solid #333;
        }
    </style>
</head>
<body>
    <div>
        <img class="logo" src="https://i.ibb.co/XfvZcC5K/IMG-2060.jpg" alt="WUP PhD Logo">
    </div>

    <div>
        <a
            class="zoom-link"
            href="https://us02web.zoom.us/j/8090516994?pwd=SjY4I9MPLMAVOQRAfxGi6J6ke04Gfg.1"
            target="_blank"
            rel="noopener noreferrer"
        >
            Zoom Link
        </a>
    </div>

    <br><br>

    <div>
        <a
            class="drive-link BA321"
            href="https://drive.google.com/open?id=1LUWgbJljkcapzuFFzCwByFkOIVOO97bP&usp=drive_copy"
            target="_blank"
            rel="noopener noreferrer"
        >
            BA321 - Research Publication 2
        </a>
    </div>

    <div>
        <a
            class="drive-link BA322"
            href="https://drive.google.com/open?id=1Nwf0zNMtiw5HhQUSm62n2y8J7z3Jb7LP&usp=drive_copy"
            target="_blank"
            rel="noopener noreferrer"
        >
            BA322 - Data And Business Analytics
        </a>
    </div>

    <div>
        <a
            class="drive-link BA326"
            href="https://drive.google.com/open?id=1eeMsx4v5NhduoCs6yJhYoK4l-4Z8qndY&usp=drive_copy"
            target="_blank"
            rel="noopener noreferrer"
        >
            BA326 - Advanced Economics Theories And Policies
        </a>
    </div>

    <div>
        <a
            class="drive-link BA329"
            href="https://drive.google.com/open?id=1ihSzTO30_vZrQ48hSxCZ86m1-GivJsfv&usp=drive_copy"
            target="_blank"
            rel="noopener noreferrer"
        >
            BA329 - Education in Business Administration
        </a>
    </div>

    <div>
        <a
            class="drive-link BA330"
            href="https://drive.google.com/open?id=1lzkTJaTkmF7OnaOnXKN2PEDU5Tfh677I&usp=drive_copy"
            target="_blank"
            rel="noopener noreferrer"
        >
            BA330 - Wesleyan Spirituality And Advocacies
        </a>
    </div>

    <!-- Dynamic note at the bottom -->
    <div id="folder-status"  style="white-space: pre-line; margin-top: 40px; font-size: 14px; padding: 10px;">  style="white-space: pre-line; margin-top: 40px; font-size: 14px; padding: 10px;"
        Loading Google Drive folder status...
    </div>

    <script>
        const STATUS_API_URL = "https://script.google.com/macros/s/AKfycbyollenXMXxuawkcUdW2nJWJ03qg3kWt_aHLte0fq-ZjyHHhw-5Dvu7uyS-AhkepQ7i/exec";

		async function loadFolderStatus() {
			const container = document.getElementById("folder-status");
			try {
				const res = await fetch(STATUS_API_URL);
				if (!res.ok) throw new Error("HTTP " + res.status);

				const data = await res.json();

				// Determine the most recent update across all folders
				const lastChanges = data.folders
					.map(f => f.lastUpdated ? new Date(f.lastUpdated) : null)
					.filter(d => d !== null);

				if (lastChanges.length === 0) {
					container.textContent = "";   // no files at all â†’ display nothing
					return;
				}

				const newest = new Date(Math.max.apply(null, lastChanges));

				// If no change within last 24 hours, hide the note
				const now = new Date();
				const diffHours = (now - newest) / 36e5;

				if (diffHours > 24) {
					container.textContent = "";   // hide note when no recent change
					return;
				}

				// Create multi-line summary when changes exist
				let lines = [];
				lines.push("Recent updates in the Google Drive folders:");

				data.folders.forEach(f => {
					const updated = f.lastUpdated
						? new Date(f.lastUpdated).toLocaleString()
						: "no files";
					lines.push(f.name + ": " + f.fileCount + " files, last update " + updated);
				});

				container.textContent = lines.join("\n");

			} catch (err) {
				console.error(err);
				container.textContent = "";
			}
		}

		document.addEventListener("DOMContentLoaded", loadFolderStatus);
	</script>
	
</body>
</html>
