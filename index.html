<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WUP_PhD_2024-25</title>
  <link rel="icon" type="image/jpeg" href="https://i.ibb.co/XfvZcC5K/IMG-2060.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background-color: grey;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 40px;
    }
    .logo {
      max-width: 125px;
      height: auto;
    }
    .zoom-link {
      display: inline-block;
      margin-top: 30px;
      padding: 3px 6px;
      text-decoration: none;
      border: 1px solid #333;
      border-radius: 2px;
      font-size: 14px;
    }
    .zoom-link:hover {
      background-color: #f0f0f0;
    }
    .drive-link {
      display: inline-block;
      margin-top: 10px;
    }
    .folder-status-inline {
      font-size: 12px;
      margin-left: 6px;
    }

    /* Style for all link states */
    a, a:visited, a:hover {
      color: blue;
      text-decoration: none;
    }
    a:hover {
      color: black;
      text-decoration: underline;
    }

    .greeting {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 20px;
      color: white;
    }
  </style>
</head>

<body>
  <div id="greeting" class="greeting"></div>

  <div>
    <a 
      href="https://www.wesleyan.edu.ph/grad_school/"
      target="_blank"
      rel="noopener noreferrer"
    >
      <img class="logo" src="Grad_School_Logo_for_web.png" alt="WUP PhD Logo" />
    </a>
  </div>

  <table style="margin: 30px auto 0 auto; border-collapse: collapse; border: none; background: none;">
    <tr>
      <td style="padding: 0 10px; border: none;">
        <a
          class="zoom-link"
          href="https://us02web.zoom.us/j/8090516994?pwd=SjY4I9MPLMAVOQRAfxGi6J6ke04Gfg.1"
          target="_blank"
          rel="noopener noreferrer"
          style="margin-top: 0;"
        >
          Zoom Link
        </a>
      </td>
      <td style="padding: 0 10px; border: none;">
        <a
          class="zoom-link"
          style="border-color: black; color: orange; margin-top: 0;" 
          href="TimeSchedule.html"
        >
          View Full Time Schedule
        </a>
      </td>
    </tr>
  </table>
  
  <div id="weekly-schedule-container" style="margin-top: 30px; color: white; text-align: center;">
    <h3 id="week-title" style="color: yellow;">Loading This Week's Schedule...</h3>
    <div id="schedule-list" style="display: inline-block; text-align: left; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; border: 1px solid #555;">
    </div>
  </div>
  <br />

  <div>
    <a
      class="drive-link"
      data-folder-name="BA321 - Research Publication 2"
      href="https://drive.google.com/open?id=1lzkTJaTkmF7OnaOnXKN2PEDU5Tfh677I&usp=drive_copy"
      target="_blank"
      rel="noopener noreferrer"
    >
      BA321 - Research Publication 2
    </a>, by Dr. Ryan John de Lara
    <span class="folder-status-inline" data-folder-name="BA321 - Research Publication 2"></span>
  </div>

  <div>
    <a
      class="drive-link"
      data-folder-name="BA322 - Data And Business Analytics"
      href="https://drive.google.com/open?id=1ihSzTO30_vZrQ48hSxCZ86m1-GivJsfv&usp=drive_copy"
      target="_blank"
      rel="noopener noreferrer"
    >
      BA322 - Data And Business Analytics
    </a>, by Dr. Raymond Cheng
    <span class="folder-status-inline" data-folder-name="BA322 - Data And Business Analytics"></span>
	<br>
	<font color="yellow">BA322 - Youtube videos: </font>
	<a
      class="drive-link"
      data-folder-name="BA322 - Lessons 1"
      href="https://www.youtube.com/watch?v=K68EIQJjWx8"
      target="_blank"
      rel="noopener noreferrer"> 01 
	</a>
	<a
      class="drive-link"
      data-folder-name="BA322 - Lessons 1"
      href="https://www.youtube.com/watch?v=8uOmaBiqliY"
      target="_blank"
      rel="noopener noreferrer"> 02 
	</a>
  </div>

  <div>
    <a
      class="drive-link"
      data-folder-name="BA326 - Advanced Economics Theories And Policies"
      href="https://drive.google.com/open?id=1eeMsx4v5NhduoCs6yJhYoK4l-4Z8qndY&usp=drive_copy"
      target="_blank"
      rel="noopener noreferrer"
    >
      BA326 - Advanced Economics Theories And Policies
    </a>, by Dr. Dulce Amor Padilla
    <span class="folder-status-inline" data-folder-name="BA326 - Advanced Economics Theories And Policies"></span>
  </div>

  <div>
    <a
      class="drive-link"
      data-folder-name="BA329 - Education in Business Administration"
      href="https://drive.google.com/open?id=1Nwf0zNMtiw5HhQUSm62n2y8J7z3Jb7LP&usp=drive_copy"
      target="_blank"
      rel="noopener noreferrer"
    >
      BA329 - Educational Theory in Business Administration
    </a>, by Dr. Joepet Portana
    <span class="folder-status-inline" data-folder-name="BA329 - Education in Business Administration"></span>
  </div>

  <div>
    <a
      class="drive-link"
      data-folder-name="BA330 - Wesleyan Spirituality And Advocacies"
      href="https://drive.google.com/open?id=1LUWgbJljkcapzuFFzCwByFkOIVOO97bP&usp=drive_copy"
      target="_blank"
      rel="noopener noreferrer"
    >
      BA330 - Wesleyan Spirituality And Advocacies
    </a>, by Dr. Wilfredo Ramos
    <span class="folder-status-inline" data-folder-name="BA330 - Wesleyan Spirituality And Advocacies"></span>
  </div>
  
  <br>
  
  <a href='https://www.free-counters.org/'>.</a> 
  <script type='text/javascript' src='https://www.freevisitorcounters.com/auth.php?id=51475035ce217cef878922c400b03e7f2b5919bc'></script>
  <script type="text/javascript" src="https://www.freevisitorcounters.com/en/home/counter/1461646/t/1"></script>

  <script>
    function getGreeting() {
      const hour = new Date().getHours();
      if (hour < 12) return "Good morning";
      if (hour < 18) return "Good afternoon";
      return "Good evening";
    }

    // Check if returning visitor
    let firstVisit = localStorage.getItem("first_visit");
    if (!firstVisit) {
      localStorage.setItem("first_visit", Date.now());
      firstVisit = false;
    } else {
      firstVisit = true;
    }

    let greetMsg = getGreeting();
    greetMsg += firstVisit ? ", welcome back!" : ", welcome to the page!";
    document.getElementById("greeting").textContent = greetMsg;

    // Your Apps Script Web App endpoint
    const STATUS_API_URL =
      "https://script.google.com/macros/s/AKfycbxnMhrtlPqHdjLIkJjYzFqzweD2VV_B362VBRmJX-gRhqZb6Q4ixo0TmJHw4EaChhopUQ/exec";

    async function loadFolderStatus() {
      try {
        const res = await fetch(STATUS_API_URL);
        if (!res.ok) throw new Error("HTTP " + res.status);

        const data = await res.json();

        data.folders.forEach(f => {
          const updated = f.lastUpdated
            ? new Date(f.lastUpdated).toLocaleString()
            : "no files";

          const span = document.querySelector(
            '.folder-status-inline[data-folder-name="' + f.name + '"]'
          );

          if (span) {
            span.textContent = " (" + f.fileCount + " files, last update " + updated + ")";
          }
        });
      } catch (err) {
        console.error(err);
        // On error, do nothing (keep spans empty)
      }
    }

    document.addEventListener("DOMContentLoaded", loadFolderStatus);

    // Simple visit counter using localStorage
    let visits = localStorage.getItem("visit_count");
    visits = visits ? parseInt(visits, 10) + 1 : 1;
    localStorage.setItem("visit_count", visits);

    document.getElementById("visit-counter").textContent =
      "Your visit count on this device: " + visits;
  </script>
</body>
</html>

<script>
  const scheduleData = [
    { week: 4, course: "BA330", date: "2026-01-24", start: "08:00", end: "10:00" },
    { week: 4, course: "BA326 (Asyc)", date: "2026-01-24", start: "10:00", end: "12:00" },
    { week: 4, course: "BA329 (Asyc)", date: "2026-01-24", start: "15:00", end: "17:00" },
    { week: 4, course: "BA321", date: "2026-01-24", start: "17:00", end: "19:00" },
    { week: 5, course: "BA322", date: "2026-01-30", start: "19:00", end: "22:00" },
    { week: 5, course: "BA330 (Asyc)", date: "2026-01-31", start: "08:00", end: "10:00" },
    { week: 5, course: "BA326 (Asyc)", date: "2026-01-31", start: "10:00", end: "12:00" },
    { week: 5, course: "BA329 (Asyc)", date: "2026-01-31", start: "15:00", end: "17:00" },
    { week: 5, course: "BA321 (Asyc)", date: "2026-01-31", start: "17:00", end: "19:00" },
    { week: 6, course: "BA330", date: "2026-02-07", start: "08:00", end: "10:00" },
    { week: 6, course: "BA326", date: "2026-02-07", start: "10:00", end: "12:00" },
    { week: 6, course: "BA329", date: "2026-02-07", start: "15:00", end: "17:00" },
    { week: 6, course: "BA321", date: "2026-02-07", start: "17:00", end: "19:00" },
    { week: 7, course: "BA322", date: "2026-02-13", start: "19:00", end: "22:00" },
    { week: 7, course: "BA330 (Asyc)", date: "2026-02-14", start: "08:00", end: "10:00" },
    { week: 7, course: "BA326 (Asyc)", date: "2026-02-14", start: "10:00", end: "12:00" },
    { week: 7, course: "BA329 (Asyc)", date: "2026-02-14", start: "15:00", end: "17:00" },
    { week: 7, course: "BA321 (Asyc)", date: "2026-02-14", start: "17:00", end: "19:00" },
    { week: 8, course: "BA330 (Asyc)", date: "2026-02-21", start: "08:00", end: "10:00" },
    { week: 8, course: "BA326 (Asyc)", date: "2026-02-21", start: "10:00", end: "12:00" },
    { week: 8, course: "BA329 (Asyc)", date: "2026-02-21", start: "15:00", end: "17:00" },
    { week: 8, course: "BA321 (Asyc)", date: "2026-02-21", start: "17:00", end: "19:00" },
    { week: 9, course: "BA322", date: "2026-02-27", start: "19:00", end: "22:00" },
    { week: 9, course: "BA330", date: "2026-02-28", start: "08:00", end: "10:00" },
    { week: 9, course: "BA326", date: "2026-02-28", start: "10:00", end: "12:00" },
    { week: 9, course: "BA329", date: "2026-02-28", start: "15:00", end: "17:00" },
    { week: 9, course: "BA321", date: "2026-02-28", start: "17:00", end: "19:00" },
    { week: 10, course: "BA330", date: "2026-03-07", start: "08:00", end: "10:00" },
    { week: 10, course: "BA326", date: "2026-03-07", start: "10:00", end: "12:00" },
    { week: 10, course: "BA329", date: "2026-03-07", start: "15:00", end: "17:00" },
    { week: 10, course: "BA321", date: "2026-03-07", start: "17:00", end: "19:00" },
    { week: 11, course: "BA322", date: "2026-03-13", start: "19:00", end: "22:00" },
    { week: 11, course: "BA330", date: "2026-03-14", start: "08:00", end: "10:00" },
    { week: 11, course: "BA326", date: "2026-03-14", start: "10:00", end: "12:00" },
    { week: 11, course: "BA329", date: "2026-03-14", start: "15:00", end: "17:00" },
    { week: 11, course: "BA321", date: "2026-03-14", start: "17:00", end: "19:00" },
    { week: 12, course: "BA330 (Asyc)", date: "2026-03-21", start: "08:00", end: "10:00" },
    { week: 12, course: "BA326 (Asyc)", date: "2026-03-21", start: "10:00", end: "12:00" },
    { week: 12, course: "BA329 (Asyc)", date: "2026-03-21", start: "15:00", end: "17:00" },
    { week: 12, course: "BA321 (Asyc)", date: "2026-03-21", start: "17:00", end: "19:00" },
    { week: 13, course: "BA322", date: "2026-03-27", start: "19:00", end: "22:00" },
    { week: 13, course: "BA330", date: "2026-03-28", start: "08:00", end: "10:00" },
    { week: 13, course: "BA326", date: "2026-03-28", start: "10:00", end: "12:00" },
    { week: 13, course: "BA329", date: "2026-03-28", start: "15:00", end: "17:00" },
    { week: 13, course: "BA321", date: "2026-03-28", start: "17:00", end: "19:00" },
    { week: 14, course: "BA330", date: "2026-04-04", start: "08:00", end: "10:00" },
    { week: 14, course: "BA326", date: "2026-04-04", start: "10:00", end: "12:00" },
    { week: 14, course: "BA329", date: "2026-04-04", start: "15:00", end: "17:00" },
    { week: 14, course: "BA321", date: "2026-04-04", start: "17:00", end: "19:00" },
    { week: 15, course: "BA330", date: "2026-04-11", start: "08:00", end: "10:00" },
    { week: 15, course: "BA326", date: "2026-04-11", start: "10:00", end: "12:00" },
    { week: 15, course: "BA329", date: "2026-04-11", start: "15:00", end: "17:00" },
    { week: 15, course: "BA321", date: "2026-04-11", start: "17:00", end: "19:00" }
  ];

  function displayWeeklySchedule() {
    const now = new Date();
    const gmt8Now = new Date(now.toLocaleString("en-US", {timeZone: "Asia/Shanghai"}));
    
    const startOfWeek = new Date(gmt8Now);
    startOfWeek.setDate(gmt8Now.getDate() - gmt8Now.getDay());
    startOfWeek.setHours(0, 0, 0, 0);

    const baseDate = new Date("2026-01-18T00:00:00+08:00");
    const diffWeeks = Math.floor((startOfWeek - baseDate) / (7 * 24 * 60 * 60 * 1000));
    const currentWeekNum = 4 + diffWeeks;

    const container = document.getElementById("schedule-list");
    const title = document.getElementById("week-title");
    container.innerHTML = "";

    const weeklyClasses = scheduleData.filter(c => c.week === currentWeekNum);

    if (weeklyClasses.length === 0) {
      title.textContent = "No classes for Week " + currentWeekNum;
      return;
    }

    title.textContent = "Week " + currentWeekNum + " Schedule";

    weeklyClasses.forEach(item => {
      const startDT = new Date(`${item.date}T${item.start}:00+08:00`);
      const endDT = new Date(`${item.date}T${item.end}:00+08:00`);

      const lDate = startDT.toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' });
      const lStart = startDT.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });
      const lEnd = endDT.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });

      // LOGIC: Extract the course number and color it blue
      // Split by space: [0] is "BA330", [1] is "(Asyc)" (if exists)
      let parts = item.course.split(" ");
      let courseNum = `<span style="color: #3399ff;">${parts[0]}</span>`; // Light blue for visibility on grey
      let asycLabel = parts[1] ? ` <span style="color: red; font-weight: bold;">${parts[1]}</span>` : "";

      const row = document.createElement("div");
      row.style.marginBottom = "6px";
      row.style.fontSize = "13px";
      row.innerHTML = `<strong>${courseNum}${asycLabel}</strong>: ${lDate} @ ${lStart} - ${lEnd}`;
      container.appendChild(row);
    });
  }

  document.addEventListener("DOMContentLoaded", displayWeeklySchedule);
</script>




